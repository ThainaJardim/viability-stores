const axios = require('axios');
const fs = require('fs').promises
const dataJson = require("./dataJson.json");
const result = require("./message.json");

// let ceps = ['01402901','03342000','03342000','05019011','01441001','03338020','1801328','11045002','13270600','01228100','11410001','04555001','02011300','16015460','05013000','04556500','12031180','13026040','11320000','64001020','64049010','60040620','71615005','70381515','74230010','79032210','12246260','38411106','13209011','13309050','54410070','60165080','04010000','74810030','06543001','14025230','49025750','05023000','12242000','14804300','04702000','01222010','01489900','01401002','04028001','05461010','60150161','04671090','05641020','60150160','06454010','01410002','04617014','70297400','71505000','01322000','70297400','60175650','60165081','12420010','12460000','20270231','12606050','58040000','58037000','22050002','03310000','06709015','02040070','05513300','13084008','52020220','05676120','01317001','04367050','22031070','22061000','22640101','22640100','22231000','22430220','71205080','18700110','22270000','05305011','41760000','04537002','04115090','24210445','05717270','11030600','11040000','04563003','11600000','04074010','13105000','06709150','04042001','05051000','11250000','02405000','03338020','02413100','02512000','13630115','12020070','04308001','05405200','05059000','11440000','71925180','13042105','60811341','74230042','02350000','06541005','64048400','15025000','04005001','13334085','15015400','05461000','04627001','05716070','15061768','11444000','04089015','11065200','17010250','17012055','04515010','04537002','04144000','09710060','02013004','13073300','09090060','09541001','17501090','18600200','19907510','13482220','24230251'
// ]

// async function getStore(cep){
//     try {
//         const { data } = await axios.get(
//             'https://api.gpa.digital/pa/v2/delivery/ecom/' + cep,
//           );
//           const storeName = data.content.deliveryTypes.map(delivery => ({name: delivery.storeName, id:delivery.storeid}))

//           const result = {
//             cep,
//             stores: storeName
//             }

//          await fs.appendFile('message.txt', `${JSON.stringify(result)},`, function (err) {
//             if (err) throw err;
//             console.log('Saved!');
//           });
        
//     } catch (error) {
//         console.log('Erro cep ' + cep)
//     }
   
// }
// function run(){
// for (c of ceps){

// getStore(c)

// }}

// console.log(run())

console.log(checkStore())

async function checkStore(){

    for (loja of dataJson){
        let cepPlanilha = loja.CEP
        let lojasEncontradas = result.filter(x => 
            x.cep === cepPlanilha
        )
        if (lojasEncontradas.length > 0){
        lojasEncontradas[0].stores.forEach(x => {
            if (loja["NOME DA LOJA"].includes(x.name))
            console.log(loja["NOME DA LOJA"] + " ok")
           
        })


    } else {
        console.log('NÃ£o encontrada lojas para o cep ' + loja.CEP + ' de nome ' + loja["NOME DA LOJA"])
    

    }
  
    }

}